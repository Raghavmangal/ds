<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
    <link rel="shortcut icon" href="survey.png" type="image/x-icon">
    <title>Survey Dashboard</title>
    <script>
        function a() {
            if (localStorage.getItem("token") == "" || localStorage.getItem("token") == null || localStorage.getItem(
                    "token") == undefined || localStorage.getItem("token") == "null") {
                // console.log(localStorage.getItem("token"));
                window.location.replace("login.html");
            }
        }
        a();
    </script>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><b>Survey Dashboard</b></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <div class="d-flex ms-auto me-auto">
                    <p class="text-center">
                        <a href="all_view.html" accesskey="a" style="text-decoration: none;
                margin-right: 20px;
                font-size: 18px;
                color: black;
                border: 1px solid #f1f1f1;
                padding: 9px;">ALL View</a>
                        <a href="sam.html" style="text-decoration: none;
                margin-right: 20px;
                font-size: 18px;
                color: black;
                border: 1px solid #f1f1f1;
                padding: 9px;" accesskey="s" id="view">SAM View</a>

                    </p>
                </div>
                <h6 class="logout" onclick="logout()" style="cursor: pointer;">Logout</h6>
            </div>
        </div>
    </nav>
    <div class="container">
        <div class="row">
            <div class="col-4">
                <h6 class="m-3" style="float: left;">FA Id : <span id="fa_idss"></span></h6>
            </div>
            <div class="col-4">
                <h6 class="m-3" style="float: left;">FA Name : <span id="fa_namess" style="color:blue"></span></h6>
            </div>
            <div class="col-4">
                <h6 class="m-3" style="float: left;">Team Id : <a href="./index.html" accesskey="t"><span id="team_id"
                            style="color:blue"></span></a></h6>
            </div>
        </div>


    </div>
    <div class="container mt-2">
        <div class="table-responsive">
            <table class="table text-center" style="box-shadow: inset 0 -1px 0 rgb(0 0 0 / 13%);">
                <h5 class="m-3" style="float:Left">FA Summary Table</h5>
                <thead class="" style="background-color: #e7f1ff;color: #0c63e4;" id="fa_summary_table">
                    <tr>
                        <th scope="col">AC Name </th>
                        <th scope="col">AC No.</th>
                        <th scope="col">Sample Count </th>
                        <th scope="col">Start date</th>
                        <th scope="col">Last Date </th>
                    </tr>
                </thead>
                <tbody id="fa_summary">
                </tbody>
            </table>
        </div>
    </div>
    <div class="container mt-3">
        Select Date:
        <div id="reportrange"
            style="background: #fff; cursor: pointer; padding: 5px 10px; border: 3px solid #ccc;width:30% ">

            <i class="fa fa-calendar"></i>&nbsp;
            <span></span> <i class="fa fa-caret-down"></i>
        </div>
    </div>
    <div class="container mt-3">
        <div class="row" id="caste_cut_table">
            <div class="col-md-12">
                <h4 class="m-2">Caste Category</h4>
                <div class="table-responsive">
                    <table class="table text-center" style="box-shadow: inset 0 -1px 0 rgb(0 0 0 / 13%)">
                        <thead class="" style="background-color: #e7f1ff; color: #0c63e4">
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">AC Name</th>
                                <th scope="col">Jatav</th>
                                <th scope="col">Non Jatav SC</th>
                                <th scope="col">Non Yadav OBC</th>
                                <th scope="col">General</th>
                                <th scope="col">Yadav</th>
                                <th scope="col">Muslim</th>
                                <th scope="col">Others</th>
                                <th scope="col">Total</th>
                            </tr>
                        </thead>
                        <tbody id="caste_cut_body"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="row" id="age_cut_table">
            <div class="col-md-12">
                <h4 class="m-2">Age</h4>
                <div class="table-responsive">
                    <table class="table text-center" style="box-shadow: inset 0 -1px 0 rgb(0 0 0 / 13%)">
                        <thead class="" style="background-color: #e7f1ff; color: #0c63e4">
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">AC Name</th>

                                <th scope="col">18-23</th>
                                <th scope="col">24-35</th>
                                <th scope="col">36-50</th>
                                <th scope="col">51-60</th>
                                <th scope="col">60+</th>
                                <th scope="col">Total</th>
                            </tr>
                        </thead>
                        <tbody id="age_cut_body"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="row" id="gender_cut_table">
            <div class="col-md-12">
                <h4 class="m-2">Gender</h4>
                <div class="table-responsive">
                    <table class="table text-center" style="box-shadow: inset 0 -1px 0 rgb(0 0 0 / 13%)">
                        <thead class="" style="background-color: #e7f1ff; color: #0c63e4">
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">AC Name</th>
                                <th scope="col">Male</th>
                                <th scope="col">Female</th>
                                <th scope="col">Others</th>
                                <th scope="col">Total</th>
                            </tr>
                        </thead>
                        <tbody id="gender_cut_body"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="row mt-3" id="call_duration_table">
            <div class="col-md-12">
                <h4 class="m-2">Call Duration</h4>
                <div class="table-responsive">
                    <table class="table text-center" style="box-shadow: inset 0 -1px 0 rgb(0 0 0 / 13%)">
                        <thead class="" style="background-color: #e7f1ff; color: #0c63e4">
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">
                                    <4 </th> <th scope="col">4-5
                                </th>
                                <th scope="col">5-8</th>
                                <th scope="col">8-10</th>
                                <th scope="col">10+</th>
                                <th scope="col">Total</th>

                            </tr>
                        </thead>
                        <tbody id="call_duration_body"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="row mt-3" id="call_duration_table">
            <div class="col-md-12">
                <h4 class="m-2">Avg Time Duration </h4>
                <div class="table-responsive">
                    <table class="table text-center" style="box-shadow: inset 0 -1px 0 rgb(0 0 0 / 13%)">
                        <thead class="" style="background-color: #e7f1ff; color: #0c63e4">
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">8-10am</th>
                                <th scope="col">10-12am</th>
                                <th scope="col">12-2pm</th>
                                <th scope="col">2-4pm</th>
                                <th scope="col">4-6pm</th>
                                <th scope="col">6-8pm</th>
                                <th scope="col">Total</th>

                            </tr>
                        </thead>
                        <tbody id="avg_timing_body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


    <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous">
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

    <script>
        var urla="";
        function b() {
            // console.log(window.location.href.charAt(7));
      if (window.location.href.charAt(8) == 3) {
        urla = "https://35.154.142.248/";
      } else {
        urla =  'https://shielded-forest-68279.herokuapp.com/'
      }
            if (localStorage.getItem("role_id") == 4) {
                document.getElementById("view").innerHTML = "SAM View"
            } else {
                document.getElementById("view").innerHTML = "AM View"
            }
            document.getElementById("team_id").innerHTML = localStorage.getItem("uid")
            var f = localStorage.getItem("fa_id");
            document.getElementById("fa_idss").innerHTML = f;
            // console.log(f);
            $.ajax({
                url:  urla+'api/v1/_fa_view/samples_count?uid=' + f,
                type: "get",
                headers: {
                    "Authorization": localStorage.getItem("token")
                },
                success: function (result) {
                    // console.log(result.query.length);
                    var a = '';
                    if (result.query.length == 0) {
                        a += `<tr>
                              <td>Null</td>
                              <td>0</td>
                              <td>0</td>
                              <td>0</td>
                              <td>0</td>
                              </tr>`;
                    }

                    for (i = 0; i < result.query.length; i++) {
                        a += '<tr><td>' + result.query[i][0] + '</td><td>' + result.query[i][1] +
                            '</td><td>' + result.query[i][2] + '</td><td>' + result.query[i][4] +
                            '</td><td>' + result.query[i][5] + '</td></tr>';
                    }
                    document.getElementById("fa_summary").innerHTML = a;
                }
            })

            $.ajax({
                url:  urla+'api/v1/_fa_name?uid=' + f,
                type: "get",
                headers: {
                    "Authorization": localStorage.getItem("token")
                },
                success: function (result) {
                    document.getElementById("fa_namess").innerHTML = result[0];
                }
            })
        }
        b();

        function logout() {
            localStorage.setItem("token", "");
            window.location.reload();
        }

        function fa_gender(id) {
            // // console.log(id);
        }
    </script>

    <script type="text/javascript">
        var s = "";
        var e = "";
        var f = localStorage.getItem("fa_id");
        $(function () {
            var start = moment();
            var end = moment();
            s = start.format('YYYY-MM-DD');
            e = end.format('YYYY-MM-DD')

            function cb(start, end) {
                $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));

                s = start.format('YYYY-MM-DD');
                e = end.format('YYYY-MM-DD');
                cuts();
            }
            $('#reportrange').daterangepicker({
                startDate: start,
                endDate: end,
                ranges: {
                    'Today': [moment(), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1,
                        'month').endOf('month')]
                }
            }, cb);
            cb(start, end);

        });



        // cuts script

        function cuts() {
            // console.log(f);
            // console.log("eeee", e);
            // console.log("fff", s)
            $.ajax({
                url:  urla+'api/v1/_fa_view/caste_cut?start_date=' + s +
                    '&end_date=' + e + '&uid=' + f,
                type: "get",
                headers: {
                    "Authorization": localStorage.getItem("token")
                },
                success: function (result) {

                    var a = '';
                    var s = 0;
                    var d = 0;
                    var f = 0;
                    var g = 0;
                    var h = 0;
                    var j = 0;
                    var k = 0;
                    var l = 0;
                    if (result.query.length == 0) {
                        a += `<tr><td>Null</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td><td>0</td><td>0</td><td>0</td></tr>`;
                    } else {
                        for (i = 0; i < result.query.length; i++) {
                            s += result.query[i][0];
                            d += result.query[i][1];
                            f += result.query[i][2];
                            g += result.query[i][3];
                            h += result.query[i][4];
                            j += result.query[i][5];
                            k += result.query[i][6];
                            l += result.query[i][7];

                            a += '<tr><td>' + result.query[i][9] +
                                '</td><td>' + result.query[i][
                                    8
                                ] + '</td><td>' + result.query[i][0] + '</td><td>' + result.query[i][
                                    1
                                ] +
                                '</td><td>' + result.query[i][2] + '</td><td>' + result.query[i][
                                    3
                                ] +
                                '</td><td>' + result.query[i][4] + '</td><td>' + result.query[i][5] +
                                '</td><td>' + result.query[i][6] + '</td><td>' + result.query[i][7] +
                                '</td></tr>';
                        }

                        a += '<tr style="background-color:#d1d1d1"><td>Total</td><td></td><td>' + s +
                            '  (' + Math.floor((s / l) * 100) + '%)</td><td>' + d + '  (' + Math.floor((d /
                                l) * 100) + '%)</td><td>' + f + '  (' + Math.floor((f / l) * 100) +
                            '%)</td><td>' + g + '  (' + Math.floor((g / l) * 100) + '%)</td><td>' + h +
                            '  (' + Math.floor((h / l) * 100) + '%)</td><td>' + j + '  (' + Math.floor((j /
                                l) * 100) + '%)</td><td>' + k + '  (' + Math.floor((k / l) * 100) +
                            '%)</td><td>' + l + '</td></tr>'
                    }
                    document.getElementById("caste_cut_body").innerHTML = a;
                }
            })

            $.ajax({
                url:  urla+'api/v1/_fa_view/age_cut?start_date=' +
                    s + '&end_date=' + e + '&uid=' + f,
                type: "get",
                headers: {
                    "Authorization": localStorage.getItem("token")
                },
                success: function (result) {
                    var a = '';
                    var s = 0;
                    var d = 0;
                    var f = 0;
                    var g = 0;
                    var h = 0;
                    var l = 0;

                    if (result.query.length == 0) {
                        a += `<tr>
                            <td>Null</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            <td>0</td>
                            </tr>`;
                    } else {
                        for (i = 0; i < result.query.length; i++) {
                            s += result.query[i][0];
                            d += result.query[i][1];
                            f += result.query[i][2];
                            g += result.query[i][3];
                            h += result.query[i][4];
                            l += result.query[i][5];
                            a += '<tr><td>' + result.query[i][7] + '</td><td>' + result.query[i][6] +
                                '</td><td>' + result.query[i][0] +
                                '</td><td>' + result.query[i][
                                    1
                                ] +
                                '</td><td>' + result.query[i][2] + '</td><td>' + result.query[i][
                                    3
                                ] +
                                '</td><td>' + result.query[i][4] + '</td><td>' + result.query[i][
                                    5
                                ] + '</td></tr>';

                        }
                        a += '<tr style="background-color:#d1d1d1"><td>Total</td><td></td><td>' + s +
                            '  (' + Math.floor((s / l) * 100) + '%)</td><td>' + d + '  (' + Math.floor((d /
                                l) * 100) + '%)</td><td>' + f + '  (' + Math.floor((f / l) * 100) +
                            '%)</td><td>' + g + '  (' + Math.floor((g / l) * 100) + '%)</td><td>' + h +
                            '  (' + Math.floor((h / l) * 100) + '%)</td><td>' + l + '</td></tr>'
                    }

                    document.getElementById("age_cut_body").innerHTML = a;
                }
            })

            $.ajax({
                url:  urla+'api/v1/_fa_view/gender_cut?start_date=' +
                    s + '&end_date=' + e + '&uid=' + f,
                type: "get",
                headers: {
                    "Authorization": localStorage.getItem("token")
                },
                success: function (result) {

                    var a = '';
                    var s = 0;
                    var d = 0;
                    var f = 0;
                    var l = 0;
                    if (result.query.length == 0) {
                        a += '<tr><td>Null</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>';
                    } else {
                        for (i = 0; i < result.query.length; i++) {
                            s += result.query[i][0];
                            d += result.query[i][1];
                            f += result.query[i][2];
                            l += result.query[i][3];
                            a += '<tr><td>' + result.query[i][
                                    5
                                ] + '</td><td>' + result.query[i][4] + '</td><td>' + result.query[i][0] +
                                '</td><td>' + result.query[i][
                                    1
                                ] +
                                '</td><td>' + result.query[i][2] + '</td><td>' + result.query[i][
                                    3
                                ] +
                                '</td></tr>';
                        }

                        a += '<tr style="background-color:#d1d1d1"><td>Total</td><td></td><td>' + s +
                            '  (' + Math.floor((s / l) * 100) + '%)</td><td>' + d + '  (' + Math.floor((d /
                                l) * 100) + '%)</td><td>' + f + '  (' + Math.floor((f / l) * 100) +
                            '%)</td><td>' + l + '</td></tr>'
                    }
                    document.getElementById("gender_cut_body").innerHTML = a;
                }
            })







            $.ajax({
                url:  urla+'api/v1/_fa_view/callduration?start_date=' +
                    s + '&end_date=' + e + '&uid=' + f,
                type: "get",
                headers: {
                    "Authorization": localStorage.getItem("token")
                },
                success: function (result) {
                    // console.log(result);
                    var a = '';
                    var s = 0;
                    var d = 0;
                    var f = 0;
                    var g = 0;
                    var h = 0;
                    var l = 0;
                    if (result.length == 0) {
                        a +=
                            '<tr><td>Null</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>';
                    } else {
                        for (i = 0; i < result.length; i++) {
                            s += result[i][0];
                            d += result[i][1];
                            f += result[i][2];
                            g += result[i][3];
                            h += result[i][4];
                            l += result[i][5];
                            a += '<tr><td>' + result[i][
                                    6
                                ] + '</td><td>' + result[i][0] + '</td><td>' + result[i][1] +
                                '</td><td>' + result[i][
                                    2
                                ] +
                                '</td><td>' + result[i][3] + '</td><td>' + result[i][
                                    4
                                ] +
                                '</td><td>' + result[i][
                                    5
                                ] +
                                '</td></tr>';
                        }
                        a += '<tr style="background-color:#d1d1d1"><td>Total</td><td>' + s +
                            '  (' + Math.floor((s / l) * 100) + '%)</td><td>' + d + '  (' + Math.floor((d /
                                l) * 100) + '%)</td><td>' + f + '  (' + Math.floor((f / l) * 100) +
                            '%)</td><td>' + g + '  (' + Math.floor((g / l) * 100) + '%)</td><td>' + h +
                            '  (' + Math.floor((h / l) * 100) + '%)</td><td>' + l + '</td></tr>'
                    }
                    document.getElementById("call_duration_body").innerHTML = a;
                }
            })
            $.ajax({
                url:  urla+'api/v1/_fa_view/submittime?start_date=' +
                    s + '&end_date=' + e + '&uid=' + f,
                type: "get",
                headers: {
                    "Authorization": localStorage.getItem("token")
                },
                success: function (result) {
                    // console.log(result);
                    var a = '';
                    var b = '';
                    var s = 0;
                    var d = 0;
                    var f = 0;
                    var g = 0;
                    var h = 0;
                    var j = 0;
                    var l = 0;

                    if (result.length == 0) {
                        a +=
                            '<tr><td>Null</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>';
                    } else {
                        for (i = 0; i < result.length; i++) {
                            b = result[i][0] + result[i][1] + result[i][2] + result[i][3] + result[i][
                                4
                            ] + result[i][5];

                            s += result[i][0];
                            d += result[i][1];
                            f += result[i][2];
                            g += result[i][3];
                            h += result[i][4];
                            h += result[i][5];
                            l += b;
                            a += '<tr><td>' + result[i][
                                    7
                                ] + '</td><td>' + result[i][0] + '</td><td>' + result[i][1] +
                                '</td><td>' + result[i][
                                    2
                                ] +
                                '</td><td>' + result[i][3] + '</td><td>' + result[i][
                                    4
                                ] +
                                '</td><td>' + result[i][
                                    5
                                ] +
                                '</td><td>' + b +
                                '</td></tr>';
                        }
                        a += '<tr style="background-color:#d1d1d1"><td>Total</td><td>' + s +
                            '  (' + Math.floor((s / l) * 100) + '%)</td><td>' + d + '  (' + Math.floor((d /
                                l) * 100) + '%)</td><td>' + f + '  (' + Math.floor((f / l) * 100) +
                            '%)</td><td>' + g + '  (' + Math.floor((g / l) * 100) + '%)</td><td>' + h +
                            '  (' + Math.floor((h / l) * 100) + '%)</td><td>' + j +
                            '  (' + Math.floor((j / l) * 100) + '%)</td><td>' + l + '</td></tr>'
                    }
                    document.getElementById("avg_timing_body").innerHTML = a;
                }
            })
        };

        cuts();
    </script>

</body>

</html>